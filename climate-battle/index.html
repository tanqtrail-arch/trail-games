<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>ğŸŒ æ°—å€™ãƒãƒˆãƒ«ã‚«ãƒ¼ãƒ‰</title>
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;700;900&display=swap" rel="stylesheet"/>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Zen Maru Gothic', sans-serif; overflow-x: hidden; -webkit-tap-highlight-color: transparent; }
  </style>
  <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script crossorigin src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.9/babel.min.js"></script>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
const { useState, useEffect, useCallback, useRef } = React;

const storageAPI = {
  get: async (key) => { try { const v = localStorage.getItem(key); return v ? { value: v } : null; } catch { return null; } },
  set: async (key, value) => { try { localStorage.setItem(key, value); } catch {} }
};



/* ======= DATA (with lat/lng) ======= */
const WORLD = [
  // === ã‚¢ã‚¸ã‚¢ (7) ===
  { id:1,name:"æ—¥æœ¬",capital:"æ±äº¬",emoji:"ğŸ‡¯ğŸ‡µ",lat:35.7,lng:139.7,maxTemp:39,minTemp:-4,rainfall:1530,sunnyDays:210,green:3,trivia:"å››å­£ãŒã¯ã£ãã‚Šã—ã¦ã„ã‚‹æ¸©å¸¯ã®ä»£è¡¨ï¼",zone:"æ¸©å¸¯",color:"#E86B6B" },
  { id:2,name:"ä¸­å›½",capital:"åŒ—äº¬",emoji:"ğŸ‡¨ğŸ‡³",lat:39.9,lng:116.4,maxTemp:39,minTemp:-15,rainfall:580,sunnyDays:200,green:2,trivia:"åºƒå¤§ãªå›½åœŸã§æ°—å€™ã‚‚æ§˜ã€…ï¼åŒ—äº¬ã¯ä¹¾ç‡¥ï¼",zone:"æ¸©å¸¯å¤§é™¸æ€§",color:"#e74c3c" },
  { id:3,name:"ã‚¤ãƒ³ãƒ‰",capital:"ãƒ‹ãƒ¥ãƒ¼ãƒ‡ãƒªãƒ¼",emoji:"ğŸ‡®ğŸ‡³",lat:28.6,lng:77.2,maxTemp:45,minTemp:4,rainfall:800,sunnyDays:290,green:2,trivia:"å¤ã¯45â„ƒä»¥ä¸Šï¼ãƒ¢ãƒ³ã‚¹ãƒ¼ãƒ³ã§å¤§é›¨ï¼",zone:"ç†±å¸¯ãƒ¢ãƒ³ã‚¹ãƒ¼ãƒ³",color:"#E07B39" },
  { id:4,name:"ãƒ¢ãƒ³ã‚´ãƒ«",capital:"ã‚¦ãƒ©ãƒ³ãƒãƒ¼ãƒˆãƒ«",emoji:"ğŸ‡²ğŸ‡³",lat:47.9,lng:106.9,maxTemp:35,minTemp:-40,rainfall:200,sunnyDays:260,green:2,trivia:"æ°—æ¸©å·®70â„ƒä»¥ä¸Šï¼éŠç‰§æ°‘ã®å›½ï¼",zone:"ã‚¹ãƒ†ãƒƒãƒ—",color:"#C4A35A" },
  { id:5,name:"ã‚¿ã‚¤",capital:"ãƒãƒ³ã‚³ã‚¯",emoji:"ğŸ‡¹ğŸ‡­",lat:13.8,lng:100.5,maxTemp:40,minTemp:15,rainfall:1500,sunnyDays:240,green:4,trivia:"å¹´ä¸­æš‘ã„ï¼é›¨å­£ã¯æ¯æ—¥é›¨ï¼",zone:"ç†±å¸¯",color:"#FF9F43" },
  { id:6,name:"ã‚·ãƒ³ã‚¬ãƒãƒ¼ãƒ«",capital:"ã‚·ãƒ³ã‚¬ãƒãƒ¼ãƒ«",emoji:"ğŸ‡¸ğŸ‡¬",lat:1.3,lng:103.8,maxTemp:34,minTemp:22,rainfall:2340,sunnyDays:170,green:4,trivia:"èµ¤é“ç›´ä¸‹ã§ä¸€å¹´ä¸­å¤ï¼æ¯æ—¥ã‚¹ã‚³ãƒ¼ãƒ«ï¼",zone:"ç†±å¸¯",color:"#FF6B6B" },
  { id:7,name:"éŸ“å›½",capital:"ã‚½ã‚¦ãƒ«",emoji:"ğŸ‡°ğŸ‡·",lat:37.6,lng:127.0,maxTemp:36,minTemp:-18,rainfall:1400,sunnyDays:190,green:3,trivia:"å››å­£ãŒã¯ã£ãã‚Šï¼å†¬ã¯ã¨ã¦ã‚‚å¯’ã„ï¼",zone:"æ¸©å¸¯",color:"#3498db" },
  // === ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘ (10) ===
  { id:8,name:"ã‚¤ã‚®ãƒªã‚¹",capital:"ãƒ­ãƒ³ãƒ‰ãƒ³",emoji:"ğŸ‡¬ğŸ‡§",lat:51.5,lng:-0.1,maxTemp:30,minTemp:-5,rainfall:600,sunnyDays:160,green:3,trivia:"éœ§ã®éƒ½ï¼ä¸€å¹´ä¸­ãã‚‚ã‚ŠãŒå¤šã„ï¼",zone:"è¥¿å²¸æµ·æ´‹æ€§",color:"#7B8FA1" },
  { id:9,name:"ãƒ•ãƒ©ãƒ³ã‚¹",capital:"ãƒ‘ãƒª",emoji:"ğŸ‡«ğŸ‡·",lat:48.9,lng:2.3,maxTemp:35,minTemp:-5,rainfall:640,sunnyDays:170,green:3,trivia:"æ¸©æš–ã§éã”ã—ã‚„ã™ã„ï¼ã§ã‚‚ç†±æ³¢ã‚‚ï¼",zone:"è¥¿å²¸æµ·æ´‹æ€§",color:"#2c3e50" },
  { id:10,name:"ãƒãƒ«ã‚¦ã‚§ãƒ¼",capital:"ã‚ªã‚¹ãƒ­",emoji:"ğŸ‡³ğŸ‡´",lat:59.9,lng:10.7,maxTemp:25,minTemp:-20,rainfall:800,sunnyDays:140,green:2,trivia:"å†¬ã¯ã‚ªãƒ¼ãƒ­ãƒ©ï¼å¤ã¯ç™½å¤œï¼",zone:"äºœå¯’å¸¯",color:"#4A7C59" },
  { id:11,name:"ãƒ­ã‚·ã‚¢",capital:"ãƒ¢ã‚¹ã‚¯ãƒ¯",emoji:"ğŸ‡·ğŸ‡º",lat:55.8,lng:37.6,maxTemp:30,minTemp:-42,rainfall:700,sunnyDays:135,green:2,trivia:"ä¸–ç•Œä¸€åºƒã„å›½ï¼å†¬ã¯-50â„ƒã«ã‚‚ï¼",zone:"äºœå¯’å¸¯",color:"#1B4965" },
  { id:12,name:"ã‚¹ãƒšã‚¤ãƒ³",capital:"ãƒãƒ‰ãƒªãƒ¼ãƒ‰",emoji:"ğŸ‡ªğŸ‡¸",lat:40.4,lng:-3.7,maxTemp:40,minTemp:-5,rainfall:440,sunnyDays:280,green:2,trivia:"ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘ã§ä¸€ç•ªæ—¥å·®ã—ãŒå¼·ã„ï¼",zone:"åœ°ä¸­æµ·æ€§",color:"#c0392b" },
  { id:13,name:"ã‚¢ã‚¤ã‚¹ãƒ©ãƒ³ãƒ‰",capital:"ãƒ¬ã‚¤ã‚­ãƒ£ãƒ“ã‚¯",emoji:"ğŸ‡®ğŸ‡¸",lat:64.1,lng:-21.9,maxTemp:15,minTemp:-10,rainfall:800,sunnyDays:100,green:1,trivia:"å¤ã§ã‚‚15â„ƒï¼ç«å±±ã¨æ°·æ²³ã®å³¶ï¼",zone:"äºœå¯’å¸¯",color:"#74b9ff" },
  { id:14,name:"ã‚®ãƒªã‚·ãƒ£",capital:"ã‚¢ãƒ†ãƒ",emoji:"ğŸ‡¬ğŸ‡·",lat:37.9,lng:23.7,maxTemp:40,minTemp:0,rainfall:400,sunnyDays:300,green:2,trivia:"åœ°ä¸­æµ·ã®å¤ªé™½ï¼å¹´300æ—¥æ™´ã‚Œï¼",zone:"åœ°ä¸­æµ·æ€§",color:"#0984e3" },
  { id:15,name:"ãƒ‰ã‚¤ãƒ„",capital:"ãƒ™ãƒ«ãƒªãƒ³",emoji:"ğŸ‡©ğŸ‡ª",lat:52.5,lng:13.4,maxTemp:33,minTemp:-15,rainfall:570,sunnyDays:160,green:3,trivia:"å†¬ã¯æ›‡ã‚ŠãŒå¤šãæ—¥ç…§æ™‚é–“ãŒçŸ­ã„ï¼",zone:"è¥¿å²¸æµ·æ´‹æ€§",color:"#f39c12" },
  { id:16,name:"ã‚¤ã‚¿ãƒªã‚¢",capital:"ãƒ­ãƒ¼ãƒ",emoji:"ğŸ‡®ğŸ‡¹",lat:41.9,lng:12.5,maxTemp:38,minTemp:-2,rainfall:800,sunnyDays:250,green:3,trivia:"åœ°ä¸­æµ·æ€§æ°—å€™ã§å¤ã¯ä¹¾ç‡¥ï¼å†¬ã«é›¨ï¼",zone:"åœ°ä¸­æµ·æ€§",color:"#27ae60" },
  { id:17,name:"ãƒ•ã‚£ãƒ³ãƒ©ãƒ³ãƒ‰",capital:"ãƒ˜ãƒ«ã‚·ãƒ³ã‚­",emoji:"ğŸ‡«ğŸ‡®",lat:60.2,lng:24.9,maxTemp:28,minTemp:-25,rainfall:650,sunnyDays:130,green:3,trivia:"ã‚µãƒ³ã‚¿ã®å›½ï¼å†¬ã¯æ—¥ãŒã»ã¨ã‚“ã©å‡ºãªã„ï¼",zone:"äºœå¯’å¸¯",color:"#0984e3" },
  // === ä¸­æ± (7) ===
  { id:18,name:"ã‚µã‚¦ã‚¸ã‚¢ãƒ©ãƒ“ã‚¢",capital:"ãƒªãƒ¤ãƒ‰",emoji:"ğŸ‡¸ğŸ‡¦",lat:24.7,lng:46.7,maxTemp:50,minTemp:3,rainfall:100,sunnyDays:345,green:1,trivia:"ä¸–ç•Œä¸€æš‘ã„é¦–éƒ½ã®ã²ã¨ã¤ï¼50â„ƒè¶…ãˆï¼",zone:"ç ‚æ¼ æ°—å€™",color:"#E8A735" },
  { id:19,name:"ã‚¢ãƒ©ãƒ–é¦–é•·å›½é€£é‚¦",capital:"ã‚¢ãƒ–ãƒ€ãƒ“",emoji:"ğŸ‡¦ğŸ‡ª",lat:24.5,lng:54.7,maxTemp:48,minTemp:8,rainfall:80,sunnyDays:350,green:1,trivia:"ç ‚æ¼ ã®è¶…è¿‘ä»£éƒ½å¸‚ï¼å¤ã¯48â„ƒï¼",zone:"ç ‚æ¼ æ°—å€™",color:"#2c3e50" },
  { id:20,name:"ã‚¤ãƒ©ãƒ³",capital:"ãƒ†ãƒ˜ãƒ©ãƒ³",emoji:"ğŸ‡®ğŸ‡·",lat:35.7,lng:51.4,maxTemp:42,minTemp:-8,rainfall:230,sunnyDays:280,green:1,trivia:"ç ‚æ¼ ã¨å±±ã®å›½ï¼å¤ã¯40â„ƒè¶…ãˆï¼",zone:"ä¹¾ç‡¥æ°—å€™",color:"#e67e22" },
  { id:21,name:"ãƒˆãƒ«ã‚³",capital:"ã‚¢ãƒ³ã‚«ãƒ©",emoji:"ğŸ‡¹ğŸ‡·",lat:39.9,lng:32.9,maxTemp:36,minTemp:-12,rainfall:400,sunnyDays:230,green:2,trivia:"å†…é™¸ã®é¦–éƒ½ã¯å¤æš‘ãå†¬å¯’ã„å¤§é™¸æ€§ï¼",zone:"å¤§é™¸æ€§",color:"#e74c3c" },
  { id:22,name:"ã‚¤ã‚¹ãƒ©ã‚¨ãƒ«",capital:"ã‚¨ãƒ«ã‚µãƒ¬ãƒ ",emoji:"ğŸ‡®ğŸ‡±",lat:31.8,lng:35.2,maxTemp:38,minTemp:2,rainfall:550,sunnyDays:310,green:2,trivia:"ç ‚æ¼ ã¨åœ°ä¸­æµ·ã®é–“ï¼å¤ã¯é›¨ã‚¼ãƒ­ï¼",zone:"åœ°ä¸­æµ·æ€§",color:"#3498db" },
  { id:23,name:"ã‚«ã‚¿ãƒ¼ãƒ«",capital:"ãƒ‰ãƒ¼ãƒ",emoji:"ğŸ‡¶ğŸ‡¦",lat:25.3,lng:51.5,maxTemp:48,minTemp:8,rainfall:75,sunnyDays:350,green:1,trivia:"ä¸–ç•Œä¸€æš‘ã„å›½ã®ã²ã¨ã¤ï¼å¤ã¯å¤–å‡ºå±é™ºï¼",zone:"ç ‚æ¼ æ°—å€™",color:"#6c3483" },
  { id:24,name:"ã‚ªãƒãƒ¼ãƒ³",capital:"ãƒã‚¹ã‚«ãƒƒãƒˆ",emoji:"ğŸ‡´ğŸ‡²",lat:23.6,lng:58.5,maxTemp:45,minTemp:12,rainfall:100,sunnyDays:340,green:1,trivia:"ã‚¢ãƒ©ãƒ“ã‚¢åŠå³¶ã®æ±ï¼ç ‚æ¼ ã¨æµ·ã®å›½ï¼",zone:"ç ‚æ¼ æ°—å€™",color:"#27ae60" },
  // === ã‚¢ãƒ•ãƒªã‚« (7) ===
  { id:25,name:"ã‚¨ã‚¸ãƒ—ãƒˆ",capital:"ã‚«ã‚¤ãƒ­",emoji:"ğŸ‡ªğŸ‡¬",lat:30.0,lng:31.2,maxTemp:42,minTemp:5,rainfall:25,sunnyDays:340,green:1,trivia:"ãƒ”ãƒ©ãƒŸãƒƒãƒ‰ã®å›½ï¼é›¨ã¯ã»ã¼é™ã‚‰ãªã„ï¼",zone:"ç ‚æ¼ æ°—å€™",color:"#D4A76A" },
  { id:26,name:"ã‚±ãƒ‹ã‚¢",capital:"ãƒŠã‚¤ãƒ­ãƒ“",emoji:"ğŸ‡°ğŸ‡ª",lat:-1.3,lng:36.8,maxTemp:28,minTemp:10,rainfall:900,sunnyDays:220,green:3,trivia:"èµ¤é“ä¸Šãªã®ã«é«˜åœ°ã§æ¶¼ã—ã„ï¼",zone:"é«˜åœ°æ°—å€™",color:"#e17055" },
  { id:27,name:"ãƒŠã‚¤ã‚¸ã‚§ãƒªã‚¢",capital:"ã‚¢ãƒ–ã‚¸ãƒ£",emoji:"ğŸ‡³ğŸ‡¬",lat:9.1,lng:7.5,maxTemp:38,minTemp:18,rainfall:1200,sunnyDays:220,green:3,trivia:"ã‚¢ãƒ•ãƒªã‚«æœ€å¤§ã®äººå£ï¼æš‘ãã¦é›¨ã‚‚å¤šã„ï¼",zone:"ç†±å¸¯",color:"#27ae60" },
  { id:28,name:"ã‚¨ãƒã‚ªãƒ”ã‚¢",capital:"ã‚¢ãƒ‡ã‚£ã‚¹ã‚¢ãƒ™ãƒ",emoji:"ğŸ‡ªğŸ‡¹",lat:9.0,lng:38.7,maxTemp:25,minTemp:6,rainfall:1100,sunnyDays:220,green:3,trivia:"é«˜åœ°ã®é¦–éƒ½ã§æ¶¼ã—ã„ï¼ã‚³ãƒ¼ãƒ’ãƒ¼ç™ºç¥¥ï¼",zone:"é«˜åœ°æ°—å€™",color:"#2ecc71" },
  { id:29,name:"ãƒ¢ãƒ­ãƒƒã‚³",capital:"ãƒ©ãƒãƒˆ",emoji:"ğŸ‡²ğŸ‡¦",lat:34.0,lng:-6.8,maxTemp:38,minTemp:5,rainfall:500,sunnyDays:270,green:2,trivia:"ã‚µãƒãƒ©ç ‚æ¼ ã®å…¥å£ï¼æµ·æ²¿ã„ã¯æ¸©æš–ï¼",zone:"åœ°ä¸­æµ·æ€§",color:"#e74c3c" },
  { id:30,name:"å—ã‚¢ãƒ•ãƒªã‚«",capital:"ãƒ—ãƒ¬ãƒˆãƒªã‚¢",emoji:"ğŸ‡¿ğŸ‡¦",lat:-25.7,lng:28.2,maxTemp:35,minTemp:-2,rainfall:700,sunnyDays:260,green:3,trivia:"å—åŠçƒï¼å­£ç¯€ãŒé€†ã§å†¬ã¯6æœˆï¼",zone:"æ¸©å¸¯(å—åŠçƒ)",color:"#2ecc71" },
  { id:31,name:"ã‚¿ãƒ³ã‚¶ãƒ‹ã‚¢",capital:"ãƒ‰ãƒ‰ãƒ",emoji:"ğŸ‡¹ğŸ‡¿",lat:-6.2,lng:35.7,maxTemp:33,minTemp:14,rainfall:600,sunnyDays:250,green:3,trivia:"ã‚­ãƒªãƒãƒ³ã‚¸ãƒ£ãƒ­ãŒã‚ã‚‹ï¼ã‚µãƒãƒ³ãƒŠã®å›½ï¼",zone:"ç†±å¸¯",color:"#00b894" },
  // === åŒ—ã‚¢ãƒ¡ãƒªã‚« (7) ===
  { id:32,name:"ã‚¢ãƒ¡ãƒªã‚«",capital:"ãƒ¯ã‚·ãƒ³ãƒˆãƒ³D.C.",emoji:"ğŸ‡ºğŸ‡¸",lat:38.9,lng:-77.0,maxTemp:38,minTemp:-8,rainfall:1000,sunnyDays:200,green:3,trivia:"åºƒã™ãã¦ç ‚æ¼ ã‚‚é›ªå›½ã‚‚ã‚ã‚‹å›½ï¼",zone:"æ¸©å¸¯",color:"#3B5998" },
  { id:33,name:"ã‚«ãƒŠãƒ€",capital:"ã‚ªã‚¿ãƒ¯",emoji:"ğŸ‡¨ğŸ‡¦",lat:45.4,lng:-75.7,maxTemp:32,minTemp:-30,rainfall:940,sunnyDays:155,green:3,trivia:"å†¬ã¯-30â„ƒï¼ã§ã‚‚å¤ã¯æš‘ã„ï¼",zone:"äºœå¯’å¸¯",color:"#2ecc71" },
  { id:34,name:"ãƒ¡ã‚­ã‚·ã‚³",capital:"ãƒ¡ã‚­ã‚·ã‚³ã‚·ãƒ†ã‚£",emoji:"ğŸ‡²ğŸ‡½",lat:19.4,lng:-99.1,maxTemp:30,minTemp:2,rainfall:800,sunnyDays:230,green:3,trivia:"é«˜åœ°ã®é¦–éƒ½ã§æ„å¤–ã¨æ¶¼ã—ã„ï¼",zone:"é«˜åœ°æ°—å€™",color:"#00b894" },
  { id:35,name:"ã‚­ãƒ¥ãƒ¼ãƒ",capital:"ãƒãƒãƒŠ",emoji:"ğŸ‡¨ğŸ‡º",lat:23.1,lng:-82.4,maxTemp:35,minTemp:15,rainfall:1200,sunnyDays:250,green:4,trivia:"ã‚«ãƒªãƒ–æµ·ã®å³¶å›½ï¼ãƒãƒªã‚±ãƒ¼ãƒ³ãŒæ¥ã‚‹ï¼",zone:"ç†±å¸¯",color:"#0984e3" },
  { id:36,name:"ã‚¸ãƒ£ãƒã‚¤ã‚«",capital:"ã‚­ãƒ³ã‚°ã‚¹ãƒˆãƒ³",emoji:"ğŸ‡¯ğŸ‡²",lat:18.0,lng:-76.8,maxTemp:34,minTemp:20,rainfall:1300,sunnyDays:240,green:4,trivia:"ã‚«ãƒªãƒ–ã®æ¥½åœ’ï¼ãƒ¬ã‚²ã‚¨ã®æ•…éƒ·ï¼",zone:"ç†±å¸¯",color:"#f1c40f" },
  { id:37,name:"ã‚³ã‚¹ã‚¿ãƒªã‚«",capital:"ã‚µãƒ³ãƒ›ã‚»",emoji:"ğŸ‡¨ğŸ‡·",lat:9.9,lng:-84.1,maxTemp:28,minTemp:14,rainfall:1800,sunnyDays:180,green:5,trivia:"è‡ªç„¶ã®å®åº«ï¼é«˜åœ°ã§æ¶¼ã—ã„é¦–éƒ½ï¼",zone:"ç†±å¸¯é«˜åœ°",color:"#27ae60" },
  { id:38,name:"ãƒ‘ãƒŠãƒ",capital:"ãƒ‘ãƒŠãƒã‚·ãƒ†ã‚£",emoji:"ğŸ‡µğŸ‡¦",lat:9.0,lng:-79.5,maxTemp:34,minTemp:22,rainfall:1900,sunnyDays:160,green:5,trivia:"é‹æ²³ã®å›½ï¼ä¸€å¹´ä¸­è’¸ã—æš‘ã„ï¼",zone:"ç†±å¸¯",color:"#2c3e50" },
  // === å—ã‚¢ãƒ¡ãƒªã‚« (7) ===
  { id:39,name:"ãƒ–ãƒ©ã‚¸ãƒ«",capital:"ãƒ–ãƒ©ã‚¸ãƒªã‚¢",emoji:"ğŸ‡§ğŸ‡·",lat:-15.8,lng:-47.9,maxTemp:34,minTemp:20,rainfall:2500,sunnyDays:150,green:5,trivia:"ã‚¢ãƒã‚¾ãƒ³ã¯ä¸–ç•Œã®é…¸ç´ ã®20%ã‚’ä½œã‚‹ï¼",zone:"ç†±å¸¯é›¨æ—",color:"#2D8B46" },
  { id:40,name:"ã‚¢ãƒ«ã‚¼ãƒ³ãƒãƒ³",capital:"ãƒ–ã‚¨ãƒã‚¹ã‚¢ã‚¤ãƒ¬ã‚¹",emoji:"ğŸ‡¦ğŸ‡·",lat:-34.6,lng:-58.4,maxTemp:36,minTemp:-2,rainfall:1100,sunnyDays:220,green:3,trivia:"å—ç±³ã®ãƒ‘ãƒªï¼ãƒ‘ã‚¿ã‚´ãƒ‹ã‚¢ã¯æ¥µå¯’ï¼",zone:"æ¸©å¸¯(å—åŠçƒ)",color:"#3498db" },
  { id:41,name:"ãƒšãƒ«ãƒ¼",capital:"ãƒªãƒ",emoji:"ğŸ‡µğŸ‡ª",lat:-12.0,lng:-77.0,maxTemp:30,minTemp:14,rainfall:10,sunnyDays:150,green:1,trivia:"ç ‚æ¼ ã®é¦–éƒ½ï¼ã»ã¼é›¨ãŒé™ã‚‰ãªã„ï¼",zone:"ç ‚æ¼ æ°—å€™",color:"#e67e22" },
  { id:42,name:"ã‚³ãƒ­ãƒ³ãƒ“ã‚¢",capital:"ãƒœã‚´ã‚¿",emoji:"ğŸ‡¨ğŸ‡´",lat:4.7,lng:-74.1,maxTemp:20,minTemp:5,rainfall:1000,sunnyDays:160,green:4,trivia:"èµ¤é“è¿‘ããªã®ã«é«˜åœ°ã§æ¶¼ã—ã„ï¼",zone:"é«˜åœ°æ°—å€™",color:"#f1c40f" },
  { id:43,name:"ãƒãƒª",capital:"ã‚µãƒ³ãƒ†ã‚£ã‚¢ã‚´",emoji:"ğŸ‡¨ğŸ‡±",lat:-33.4,lng:-70.6,maxTemp:34,minTemp:-2,rainfall:340,sunnyDays:260,green:2,trivia:"å—åŒ—ã«ç´°é•·ã„ï¼ç ‚æ¼ ã‹ã‚‰æ°·æ²³ã¾ã§ï¼",zone:"åœ°ä¸­æµ·æ€§",color:"#e74c3c" },
  { id:44,name:"ã‚¨ã‚¯ã‚¢ãƒ‰ãƒ«",capital:"ã‚­ãƒˆ",emoji:"ğŸ‡ªğŸ‡¨",lat:-0.2,lng:-78.5,maxTemp:22,minTemp:7,rainfall:1200,sunnyDays:160,green:4,trivia:"èµ¤é“ã®å›½ãªã®ã«é«˜åœ°ã§æ¶¼ã—ã„ï¼",zone:"é«˜åœ°æ°—å€™",color:"#f1c40f" },
  { id:45,name:"ãƒ™ãƒã‚ºã‚¨ãƒ©",capital:"ã‚«ãƒ©ã‚«ã‚¹",emoji:"ğŸ‡»ğŸ‡ª",lat:10.5,lng:-66.9,maxTemp:32,minTemp:15,rainfall:900,sunnyDays:200,green:4,trivia:"ã‚«ãƒªãƒ–æµ·ã«é¢ã—ãŸå¸¸å¤ã®å›½ï¼",zone:"ç†±å¸¯",color:"#e74c3c" },
  // === ã‚ªã‚»ã‚¢ãƒ‹ã‚¢ (7) ===
  { id:46,name:"ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢",capital:"ã‚­ãƒ£ãƒ³ãƒ™ãƒ©",emoji:"ğŸ‡¦ğŸ‡º",lat:-35.3,lng:149.1,maxTemp:42,minTemp:-8,rainfall:620,sunnyDays:250,green:2,trivia:"å—åŠçƒã§å­£ç¯€ãŒé€†ï¼1æœˆãŒçœŸå¤ï¼",zone:"æ¸©å¸¯(å—åŠçƒ)",color:"#F0932B" },
  { id:47,name:"ãƒ‹ãƒ¥ãƒ¼ã‚¸ãƒ¼ãƒ©ãƒ³ãƒ‰",capital:"ã‚¦ã‚§ãƒªãƒ³ãƒˆãƒ³",emoji:"ğŸ‡³ğŸ‡¿",lat:-41.3,lng:174.8,maxTemp:25,minTemp:-2,rainfall:1200,sunnyDays:180,green:4,trivia:"é¢¨ãŒã™ã”ãå¼·ã„é¦–éƒ½ï¼è‡ªç„¶ãŒè±Šã‹ï¼",zone:"æ¸©å¸¯(å—åŠçƒ)",color:"#2d3436" },
  { id:48,name:"ãƒ‘ãƒ—ã‚¢ãƒ‹ãƒ¥ãƒ¼ã‚®ãƒ‹ã‚¢",capital:"ãƒãƒ¼ãƒˆãƒ¢ãƒ¬ã‚¹ãƒ“ãƒ¼",emoji:"ğŸ‡µğŸ‡¬",lat:-9.5,lng:147.2,maxTemp:33,minTemp:22,rainfall:1200,sunnyDays:200,green:5,trivia:"ç†±å¸¯ã®å³¶å›½ï¼800ä»¥ä¸Šã®è¨€èªãŒã‚ã‚‹ï¼",zone:"ç†±å¸¯",color:"#e74c3c" },
  { id:49,name:"ãƒ•ã‚£ã‚¸ãƒ¼",capital:"ã‚¹ãƒ",emoji:"ğŸ‡«ğŸ‡¯",lat:-18.1,lng:178.4,maxTemp:32,minTemp:18,rainfall:3000,sunnyDays:170,green:5,trivia:"å—å¤ªå¹³æ´‹ã®æ¥½åœ’ï¼é›¨ãŒã¨ã¦ã‚‚å¤šã„ï¼",zone:"ç†±å¸¯",color:"#0984e3" },
  { id:50,name:"ã‚µãƒ¢ã‚¢",capital:"ã‚¢ãƒ”ã‚¢",emoji:"ğŸ‡¼ğŸ‡¸",lat:-13.8,lng:-171.8,maxTemp:32,minTemp:22,rainfall:2900,sunnyDays:170,green:5,trivia:"ãƒãƒªãƒã‚·ã‚¢ã®å³¶ï¼ä¸€å¹´ä¸­æ¸©æš–ï¼",zone:"ç†±å¸¯",color:"#27ae60" },
  { id:51,name:"ãƒˆãƒ³ã‚¬",capital:"ãƒŒã‚¯ã‚¢ãƒ­ãƒ•ã‚¡",emoji:"ğŸ‡¹ğŸ‡´",lat:-21.2,lng:-175.2,maxTemp:31,minTemp:16,rainfall:1700,sunnyDays:190,green:4,trivia:"å¤ªå¹³æ´‹ã®ç‹å›½ï¼ã‚µã‚¤ã‚¯ãƒ­ãƒ³ãŒæ¥ã‚‹ï¼",zone:"ç†±å¸¯",color:"#e74c3c" },
  { id:52,name:"ãƒ‘ãƒ©ã‚ª",capital:"ãƒãƒ«ã‚±ã‚ªã‚¯",emoji:"ğŸ‡µğŸ‡¼",lat:7.5,lng:134.6,maxTemp:32,minTemp:24,rainfall:3800,sunnyDays:150,green:5,trivia:"ä¸–ç•Œä¸€ã®é€æ˜åº¦ã®æµ·ï¼é›¨ã‚‚å¤šã„ï¼",zone:"ç†±å¸¯",color:"#00b4d8" },
];

const JAPAN = [
  { id:1,name:"åŒ—æµ·é“",capital:"æœ­å¹Œ",emoji:"ğŸ¦€",lat:43.1,lng:141.3,maxTemp:31,minTemp:-25,rainfall:1100,sunnyDays:180,snow:5,trivia:"æ—¥æœ¬ä¸€å¯’ã„ï¼-41â„ƒã®è¨˜éŒ²ï¼",zone:"äºœå¯’å¸¯",color:"#1B9CFC" },
  { id:2,name:"é’æ£®",capital:"é’æ£®å¸‚",emoji:"ğŸ",lat:40.8,lng:140.7,maxTemp:33,minTemp:-15,rainfall:1300,sunnyDays:160,snow:5,trivia:"ã‚Šã‚“ã”æ—¥æœ¬ä¸€ï¼ä¸–ç•Œæœ‰æ•°ã®è±ªé›ªï¼",zone:"æ—¥æœ¬æµ·å´",color:"#e74c3c" },
  { id:3,name:"å²©æ‰‹",capital:"ç››å²¡å¸‚",emoji:"ğŸ¡",lat:39.7,lng:141.2,maxTemp:33,minTemp:-16,rainfall:1300,sunnyDays:175,snow:4,trivia:"æ²¿å²¸ã¨å†…é™¸ã§æ°—å€™ãŒå…¨ç„¶é•ã†ï¼",zone:"å¤ªå¹³æ´‹å´",color:"#636e72" },
  { id:4,name:"å®®åŸ",capital:"ä»™å°å¸‚",emoji:"ğŸŒ¿",lat:38.3,lng:140.9,maxTemp:35,minTemp:-7,rainfall:1250,sunnyDays:190,snow:2,trivia:"æœã®éƒ½ï¼æ±åŒ—ã§ã¯æ¯”è¼ƒçš„æ¸©æš–ï¼",zone:"å¤ªå¹³æ´‹å´",color:"#2ecc71" },
  { id:5,name:"ç§‹ç”°",capital:"ç§‹ç”°å¸‚",emoji:"ğŸŒ¾",lat:39.7,lng:140.1,maxTemp:34,minTemp:-14,rainfall:1700,sunnyDays:145,snow:5,trivia:"æ™´ã‚Œã®æ—¥ãŒæ—¥æœ¬ã§æœ€å°‘ãƒ¬ãƒ™ãƒ«ï¼",zone:"æ—¥æœ¬æµ·å´",color:"#6c5ce7" },
  { id:6,name:"å±±å½¢",capital:"å±±å½¢å¸‚",emoji:"ğŸ’",lat:38.3,lng:140.3,maxTemp:37,minTemp:-12,rainfall:1170,sunnyDays:170,snow:4,trivia:"ã•ãã‚‰ã‚“ã¼æ—¥æœ¬ä¸€ï¼ç›†åœ°ã§å¤æš‘ã„ï¼",zone:"æ—¥æœ¬æµ·å´",color:"#e74c3c" },
  { id:7,name:"ç¦å³¶",capital:"ç¦å³¶å¸‚",emoji:"ğŸ‘",lat:37.8,lng:140.5,maxTemp:37,minTemp:-10,rainfall:1200,sunnyDays:185,snow:3,trivia:"ç›†åœ°ã§å¤ã¯æš‘ã„ï¼æ¡ƒã®åç”£åœ°ï¼",zone:"å¤ªå¹³æ´‹å´",color:"#fd79a8" },
  { id:8,name:"èŒ¨åŸ",capital:"æ°´æˆ¸å¸‚",emoji:"ğŸŒ¸",lat:36.3,lng:140.4,maxTemp:36,minTemp:-7,rainfall:1350,sunnyDays:200,snow:1,trivia:"å•æ¥½åœ’ã®æ¢…ãŒæœ‰åï¼å¤ªå¹³æ´‹å´æ°—å€™ï¼",zone:"å¤ªå¹³æ´‹å´",color:"#0984e3" },
  { id:9,name:"æ ƒæœ¨",capital:"å®‡éƒ½å®®å¸‚",emoji:"ğŸ“",lat:36.6,lng:139.9,maxTemp:36,minTemp:-8,rainfall:1500,sunnyDays:195,snow:1,trivia:"ã„ã¡ã”æ—¥æœ¬ä¸€ï¼é›·ãŒå¤šã„çœŒï¼",zone:"å†…é™¸æ€§",color:"#e74c3c" },
  { id:10,name:"ç¾¤é¦¬",capital:"å‰æ©‹å¸‚",emoji:"â™¨ï¸",lat:36.4,lng:139.1,maxTemp:39,minTemp:-7,rainfall:1250,sunnyDays:210,snow:1,trivia:"ã‹ã‚‰ã£é¢¨ãŒæœ‰åï¼å¤ã¯çŒ›æš‘ï¼",zone:"å†…é™¸æ€§",color:"#27ae60" },
  { id:11,name:"åŸ¼ç‰",capital:"ã•ã„ãŸã¾å¸‚",emoji:"ğŸŸï¸",lat:35.9,lng:139.6,maxTemp:39,minTemp:-6,rainfall:1300,sunnyDays:210,snow:1,trivia:"ç†Šè°·ã¯æ—¥æœ¬æœ€é«˜æ°—æ¸©41.1â„ƒã‚’è¨˜éŒ²ï¼",zone:"å¤ªå¹³æ´‹å´",color:"#0984e3" },
  { id:12,name:"åƒè‘‰",capital:"åƒè‘‰å¸‚",emoji:"ğŸ¥œ",lat:35.6,lng:140.1,maxTemp:37,minTemp:-5,rainfall:1500,sunnyDays:200,snow:0,trivia:"ä¸‰æ–¹ã‚’æµ·ã«å›²ã¾ã‚Œã¦æ¸©æš–ï¼",zone:"å¤ªå¹³æ´‹å´",color:"#e67e22" },
  { id:13,name:"æ±äº¬",capital:"æ±äº¬",emoji:"ğŸ—¼",lat:35.7,lng:139.7,maxTemp:39,minTemp:-4,rainfall:1530,sunnyDays:210,snow:1,trivia:"ãƒ’ãƒ¼ãƒˆã‚¢ã‚¤ãƒ©ãƒ³ãƒ‰ã§å¹´ã€…æš‘ãï¼",zone:"å¤ªå¹³æ´‹å´",color:"#e94560" },
  { id:14,name:"ç¥å¥ˆå·",capital:"æ¨ªæµœå¸‚",emoji:"ğŸš¢",lat:35.4,lng:139.6,maxTemp:37,minTemp:-4,rainfall:1600,sunnyDays:200,snow:0,trivia:"æµ·ã«é¢ã—ã¦æ¸©æš–ï¼ç®±æ ¹ã¯é›ªã‚‚ï¼",zone:"å¤ªå¹³æ´‹å´",color:"#3498db" },
  { id:15,name:"æ–°æ½Ÿ",capital:"æ–°æ½Ÿå¸‚",emoji:"ğŸš",lat:37.9,lng:139.0,maxTemp:35,minTemp:-10,rainfall:1800,sunnyDays:150,snow:5,trivia:"ç±³ã©ã“ã‚æ—¥æœ¬ä¸€ï¼å†¬ã¯å¤§é›ªï¼",zone:"æ—¥æœ¬æµ·å´",color:"#27ae60" },
  { id:16,name:"å¯Œå±±",capital:"å¯Œå±±å¸‚",emoji:"ğŸ”ï¸",lat:36.7,lng:137.2,maxTemp:35,minTemp:-8,rainfall:2300,sunnyDays:150,snow:4,trivia:"é›¨ã‚‚é›ªã‚‚ã™ã”ã„ï¼ç«‹å±±ã®æµã¿ï¼",zone:"æ—¥æœ¬æµ·å´",color:"#0984e3" },
  { id:17,name:"çŸ³å·",capital:"é‡‘æ²¢å¸‚",emoji:"ğŸ¯",lat:36.6,lng:136.6,maxTemp:35,minTemp:-5,rainfall:2400,sunnyDays:155,snow:3,trivia:"å¼å½“å¿˜ã‚Œã¦ã‚‚å‚˜å¿˜ã‚Œã‚‹ãªï¼é›¨å¤šã„ï¼",zone:"æ—¥æœ¬æµ·å´",color:"#6c5ce7" },
  { id:18,name:"ç¦äº•",capital:"ç¦äº•å¸‚",emoji:"ğŸ¦•",lat:36.1,lng:136.2,maxTemp:36,minTemp:-6,rainfall:2250,sunnyDays:155,snow:4,trivia:"æç«œã®åŒ–çŸ³ãŒãŸãã•ã‚“ï¼é›ªã‚‚å¤šã„ï¼",zone:"æ—¥æœ¬æµ·å´",color:"#2ecc71" },
  { id:19,name:"å±±æ¢¨",capital:"ç”²åºœå¸‚",emoji:"ğŸ‡",lat:35.7,lng:138.6,maxTemp:39,minTemp:-8,rainfall:1100,sunnyDays:220,snow:1,trivia:"ç›†åœ°ã§å¤ã¯çŒ›æš‘ï¼ã¶ã©ã†æ—¥æœ¬ä¸€ï¼",zone:"å†…é™¸æ€§",color:"#8e44ad" },
  { id:20,name:"é•·é‡",capital:"é•·é‡å¸‚",emoji:"â›°ï¸",lat:36.7,lng:138.2,maxTemp:34,minTemp:-15,rainfall:950,sunnyDays:210,snow:3,trivia:"å±±ã«å›²ã¾ã‚Œã¦é›¨ãŒå°‘ãªã„ï¼",zone:"å†…é™¸æ€§",color:"#8e44ad" },
  { id:21,name:"å²é˜œ",capital:"å²é˜œå¸‚",emoji:"ğŸï¸",lat:35.4,lng:136.8,maxTemp:38,minTemp:-5,rainfall:1800,sunnyDays:200,snow:2,trivia:"é£›é¨¨ã¯è±ªé›ªåœ°å¸¯ï¼ç¾æ¿ƒã¯æš‘ã„ï¼",zone:"å†…é™¸æ€§",color:"#27ae60" },
  { id:22,name:"é™å²¡",capital:"é™å²¡å¸‚",emoji:"ğŸµ",lat:34.9,lng:138.4,maxTemp:37,minTemp:-2,rainfall:2325,sunnyDays:220,snow:0,trivia:"ãŠèŒ¶ã®ç”£åœ°ï¼æ™´ã‚Œã‚‚é›¨ã‚‚å¤šã„ï¼",zone:"å¤ªå¹³æ´‹å´",color:"#00cec9" },
  { id:23,name:"æ„›çŸ¥",capital:"åå¤å±‹å¸‚",emoji:"ğŸ­",lat:35.2,lng:136.9,maxTemp:39,minTemp:-5,rainfall:1550,sunnyDays:210,snow:1,trivia:"å¤ã¯è’¸ã—æš‘ã„ï¼çŒ›æš‘æ—¥ãŒå¤šã„ï¼",zone:"å¤ªå¹³æ´‹å´",color:"#e74c3c" },
  { id:24,name:"ä¸‰é‡",capital:"æ´¥å¸‚",emoji:"ğŸ¦",lat:34.7,lng:136.5,maxTemp:37,minTemp:-3,rainfall:1600,sunnyDays:200,snow:0,trivia:"å—éƒ¨ã¯é›¨ãŒã¨ã¦ã‚‚å¤šã„ï¼ä¼Šå‹¢ãˆã³ï¼",zone:"å¤ªå¹³æ´‹å´",color:"#e67e22" },
  { id:25,name:"æ»‹è³€",capital:"å¤§æ´¥å¸‚",emoji:"ğŸ›¶",lat:35.0,lng:135.9,maxTemp:36,minTemp:-5,rainfall:1500,sunnyDays:190,snow:2,trivia:"çµç¶æ¹–ãŒæ°—å€™ã«å½±éŸ¿ï¼åŒ—éƒ¨ã¯é›ªï¼",zone:"æ—¥æœ¬æµ·å´",color:"#3498db" },
  { id:26,name:"äº¬éƒ½",capital:"äº¬éƒ½å¸‚",emoji:"â›©ï¸",lat:35.0,lng:135.8,maxTemp:39,minTemp:-5,rainfall:1490,sunnyDays:200,snow:1,trivia:"ç›†åœ°ã§å¤ã¯ã‚ã¡ã‚ƒãã¡ã‚ƒæš‘ã„ï¼",zone:"ç›†åœ°",color:"#c0392b" },
  { id:27,name:"å¤§é˜ª",capital:"å¤§é˜ªå¸‚",emoji:"ğŸ¯",lat:34.7,lng:135.5,maxTemp:38,minTemp:-3,rainfall:1300,sunnyDays:210,snow:0,trivia:"ç€¬æˆ¸å†…æ°—å€™ã§æ¯”è¼ƒçš„æ¸©æš–ï¼",zone:"ç€¬æˆ¸å†…",color:"#f39c12" },
  { id:28,name:"å…µåº«",capital:"ç¥æˆ¸å¸‚",emoji:"ğŸ¥©",lat:34.7,lng:135.2,maxTemp:36,minTemp:-4,rainfall:1200,sunnyDays:210,snow:1,trivia:"å—ã¯æ¸©æš–ï¼åŒ—ã¯è±ªé›ªåœ°å¸¯ï¼å·®ãŒå¤§ãã„ï¼",zone:"ç€¬æˆ¸å†…",color:"#2c3e50" },
  { id:29,name:"å¥ˆè‰¯",capital:"å¥ˆè‰¯å¸‚",emoji:"ğŸ¦Œ",lat:34.7,lng:135.8,maxTemp:37,minTemp:-5,rainfall:1300,sunnyDays:200,snow:1,trivia:"ç›†åœ°ã§å¯’æš–å·®ãŒå¤§ãã„ï¼é¹¿ã®çœŒï¼",zone:"ç›†åœ°",color:"#e17055" },
  { id:30,name:"å’Œæ­Œå±±",capital:"å’Œæ­Œå±±å¸‚",emoji:"ğŸŠ",lat:34.2,lng:135.2,maxTemp:36,minTemp:-2,rainfall:1400,sunnyDays:210,snow:0,trivia:"ã¿ã‹ã‚“ã®åç”£åœ°ï¼é»’æ½®ã§æ¸©æš–ï¼",zone:"å¤ªå¹³æ´‹å´",color:"#e67e22" },
  { id:31,name:"é³¥å–",capital:"é³¥å–å¸‚",emoji:"ğŸ«",lat:35.5,lng:134.2,maxTemp:36,minTemp:-7,rainfall:1900,sunnyDays:165,snow:3,trivia:"ç ‚ä¸˜ãªã®ã«å®Ÿã¯é›¨ãŒå¤šã„ï¼",zone:"æ—¥æœ¬æµ·å´",color:"#D4A76A" },
  { id:32,name:"å³¶æ ¹",capital:"æ¾æ±Ÿå¸‚",emoji:"â›©ï¸",lat:35.5,lng:133.1,maxTemp:35,minTemp:-5,rainfall:1800,sunnyDays:160,snow:2,trivia:"å‡ºé›²å¤§ç¤¾ã®çœŒï¼æ—¥æœ¬æµ·å´ã§é›¨é›ªå¤šã„ï¼",zone:"æ—¥æœ¬æµ·å´",color:"#636e72" },
  { id:33,name:"å²¡å±±",capital:"å²¡å±±å¸‚",emoji:"ğŸ‘",lat:34.7,lng:133.9,maxTemp:37,minTemp:-4,rainfall:1100,sunnyDays:230,snow:0,trivia:"æ™´ã‚Œã®å›½ãŠã‹ã‚„ã¾ï¼æ—¥ç…§æ™‚é–“ãŒé•·ã„ï¼",zone:"ç€¬æˆ¸å†…",color:"#fdcb6e" },
  { id:34,name:"åºƒå³¶",capital:"åºƒå³¶å¸‚",emoji:"ğŸŒŠ",lat:34.4,lng:132.5,maxTemp:36,minTemp:-4,rainfall:1500,sunnyDays:205,snow:1,trivia:"ç€¬æˆ¸å†…æµ·ã§æ¸©æš–ï¼æ™´ã‚ŒãŒå¤šã„ï¼",zone:"ç€¬æˆ¸å†…",color:"#d63031" },
  { id:35,name:"å±±å£",capital:"å±±å£å¸‚",emoji:"ğŸ¡",lat:34.2,lng:131.5,maxTemp:36,minTemp:-4,rainfall:1700,sunnyDays:195,snow:1,trivia:"æ—¥æœ¬æµ·ã¨ç€¬æˆ¸å†…ã®ä¸¡æ–¹ã«é¢ã™ã‚‹ï¼",zone:"ç€¬æˆ¸å†…",color:"#00b894" },
  { id:36,name:"å¾³å³¶",capital:"å¾³å³¶å¸‚",emoji:"ğŸŒ€",lat:34.1,lng:134.6,maxTemp:36,minTemp:-3,rainfall:1500,sunnyDays:210,snow:0,trivia:"å°é¢¨ã®é€šã‚Šé“ï¼å—éƒ¨ã¯é›¨ãŒã™ã”ã„ï¼",zone:"å¤ªå¹³æ´‹å´",color:"#6c5ce7" },
  { id:37,name:"é¦™å·",capital:"é«˜æ¾å¸‚",emoji:"ğŸœ",lat:34.3,lng:134.0,maxTemp:36,minTemp:-3,rainfall:1100,sunnyDays:230,snow:0,trivia:"æ—¥æœ¬ã§ä¸€ç•ªé›¨ãŒå°‘ãªã„çœŒï¼ã†ã©ã‚“çœŒï¼",zone:"ç€¬æˆ¸å†…",color:"#fdcb6e" },
  { id:38,name:"æ„›åª›",capital:"æ¾å±±å¸‚",emoji:"ğŸŠ",lat:33.8,lng:132.8,maxTemp:36,minTemp:-3,rainfall:1300,sunnyDays:215,snow:0,trivia:"ã¿ã‹ã‚“ã®ç”£åœ°ï¼æ¸©æš–ã§éã”ã—ã‚„ã™ã„ï¼",zone:"ç€¬æˆ¸å†…",color:"#e67e22" },
  { id:39,name:"é«˜çŸ¥",capital:"é«˜çŸ¥å¸‚",emoji:"ğŸŸ",lat:33.6,lng:133.5,maxTemp:37,minTemp:-3,rainfall:2550,sunnyDays:220,snow:0,trivia:"æ—¥æœ¬ä¸€é›¨ãŒå¤šã„çœŒï¼å°é¢¨ã‚‚ï¼",zone:"å¤ªå¹³æ´‹å´",color:"#00b894" },
  { id:40,name:"ç¦å²¡",capital:"ç¦å²¡å¸‚",emoji:"ğŸœ",lat:33.6,lng:130.4,maxTemp:37,minTemp:-3,rainfall:1600,sunnyDays:200,snow:1,trivia:"ä¹å·ã®å…¥å£ï¼å¤§é™¸ã«è¿‘ã„ï¼",zone:"å¤ªå¹³æ´‹å´",color:"#e17055" },
  { id:41,name:"ä½è³€",capital:"ä½è³€å¸‚",emoji:"ğŸˆ",lat:33.3,lng:130.3,maxTemp:37,minTemp:-4,rainfall:1900,sunnyDays:195,snow:1,trivia:"æœ‰æ˜æµ·ã«é¢ã™ã‚‹ï¼æ„å¤–ã¨é›¨ãŒå¤šã„ï¼",zone:"å¤ªå¹³æ´‹å´",color:"#e74c3c" },
  { id:42,name:"é•·å´",capital:"é•·å´å¸‚",emoji:"â›ª",lat:32.8,lng:129.9,maxTemp:35,minTemp:-2,rainfall:1900,sunnyDays:190,snow:0,trivia:"æµ·ã«å›²ã¾ã‚ŒãŸå‚ã®è¡—ï¼é›¨ãŒå¤šã„ï¼",zone:"å¤ªå¹³æ´‹å´",color:"#0984e3" },
  { id:43,name:"ç†Šæœ¬",capital:"ç†Šæœ¬å¸‚",emoji:"ğŸ»",lat:32.8,lng:130.7,maxTemp:37,minTemp:-4,rainfall:2000,sunnyDays:200,snow:0,trivia:"é˜¿è˜‡å±±ãŒã‚ã‚‹ï¼å¤ã¯è’¸ã—æš‘ã„ï¼",zone:"å¤ªå¹³æ´‹å´",color:"#e74c3c" },
  { id:44,name:"å¤§åˆ†",capital:"å¤§åˆ†å¸‚",emoji:"â™¨ï¸",lat:33.2,lng:131.6,maxTemp:36,minTemp:-3,rainfall:1600,sunnyDays:210,snow:0,trivia:"æ¸©æ³‰çœŒï¼åˆ¥åºœã¯æºæ³‰æ•°æ—¥æœ¬ä¸€ï¼",zone:"å¤ªå¹³æ´‹å´",color:"#e67e22" },
  { id:45,name:"å®®å´",capital:"å®®å´å¸‚",emoji:"ğŸŒ´",lat:31.9,lng:131.4,maxTemp:36,minTemp:-3,rainfall:2500,sunnyDays:220,snow:0,trivia:"æ—¥å‘ã®å›½ï¼æ¸©æš–ã§é›¨ãŒã™ã”ãå¤šã„ï¼",zone:"å¤ªå¹³æ´‹å´",color:"#27ae60" },
  { id:46,name:"é¹¿å…å³¶",capital:"é¹¿å…å³¶å¸‚",emoji:"ğŸŒ‹",lat:31.6,lng:130.6,maxTemp:36,minTemp:-3,rainfall:2300,sunnyDays:200,snow:0,trivia:"æ¡œå³¶ã®ç«å±±ç°ï¼æ¸©æš–ã§é›¨ãŒå¤šã„ï¼",zone:"å¤ªå¹³æ´‹å´",color:"#e74c3c" },
  { id:47,name:"æ²–ç¸„",capital:"é‚£è¦‡å¸‚",emoji:"ğŸŒº",lat:26.3,lng:127.7,maxTemp:35,minTemp:8,rainfall:2040,sunnyDays:190,snow:0,trivia:"ä¸€å¹´ä¸­ã‚ã£ãŸã‹ã„äºœç†±å¸¯ï¼",zone:"äºœç†±å¸¯",color:"#00b4d8" },
];
const W_ST = [
  { key:"maxTemp",label:"æœ€é«˜æ°—æ¸©",unit:"â„ƒ",emoji:"ğŸ”¥",color:"#E03131" },
  { key:"minTemp",label:"æœ€ä½æ°—æ¸©",unit:"â„ƒ",emoji:"â„ï¸",color:"#339AF0" },
  { key:"rainfall",label:"å¹´é–“é™æ°´é‡",unit:"mm",emoji:"ğŸŒ§ï¸",color:"#1C7ED6" },
  { key:"sunnyDays",label:"æ™´ã‚Œã®æ—¥æ•°",unit:"æ—¥",emoji:"â˜€ï¸",color:"#F59F00" },
  { key:"green",label:"ç·‘ã®å¤šã•",unit:"",emoji:"ğŸŒ¿",color:"#2F9E44" },
];
const J_ST = [
  { key:"maxTemp",label:"æœ€é«˜æ°—æ¸©",unit:"â„ƒ",emoji:"ğŸ”¥",color:"#E03131" },
  { key:"minTemp",label:"æœ€ä½æ°—æ¸©",unit:"â„ƒ",emoji:"â„ï¸",color:"#339AF0" },
  { key:"rainfall",label:"å¹´é–“é™æ°´é‡",unit:"mm",emoji:"ğŸŒ§ï¸",color:"#1C7ED6" },
  { key:"sunnyDays",label:"æ™´ã‚Œã®æ—¥æ•°",unit:"æ—¥",emoji:"â˜€ï¸",color:"#F59F00" },
  { key:"snow",label:"é›ªã®å¤šã•",unit:"",emoji:"â›„",color:"#74C0FC" },
];

const LVN=["","ãƒ“ã‚®ãƒŠãƒ¼","ãƒ«ãƒ¼ã‚­ãƒ¼","ãƒãƒ£ãƒ¬ãƒ³ã‚¸ãƒ£ãƒ¼","ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆ","ãƒã‚¹ã‚¿ãƒ¼","ãƒ¬ã‚¸ã‚§ãƒ³ãƒ‰","æ°—å€™ç‹"];
const LVC=["","#4CAF50","#2196F3","#FF9800","#E91E63","#9C27B0","#FF5722","#FFD700"];

function shuffle(a){const b=[...a];for(let i=b.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[b[i],b[j]]=[b[j],b[i]];}return b;}

// HIGH/LOW logic per stat
// minTemp â†’ always LOW ("ã©ã£ã¡ãŒå¯’ã„ï¼Ÿ")
// sunnyDays, green, snow â†’ always HIGH
// maxTemp, rainfall â†’ both OK (random at Lv6+)
function getHiLo(statKey, lv) {
  if (statKey === "minTemp") return false; // always LOW
  if (statKey === "sunnyDays" || statKey === "green" || statKey === "snow") return true; // always HIGH
  // maxTemp, rainfall â†’ HIGH only until Lv5, mixed at Lv6+
  if (lv <= 5) return true;
  return Math.random() > 0.4;
}

/* ======= STORAGE ======= */
const INIT={worldLv:1,japanLv:1,worldBest:0,japanBest:0,totalWins:0};
function useData(){
  const[d,setD]=useState({...INIT});
  const[ok,setOk]=useState(false);
  useEffect(()=>{let c=false;(async()=>{try{const r=await storageAPI.get("cb2");if(!c&&r&&r.value)setD(JSON.parse(r.value));}catch{}if(!c)setOk(true);})();return()=>{c=true;};},[]);
  const up=useCallback(fn=>{setD(p=>{const n=fn(p);try{storageAPI.set("cb2",JSON.stringify(n));}catch{}return n;});},[]);
  return{d,up,ok};
}

/* ======= ANIMATED NUMBER ======= */
function ANum({stat,val,hide,spin}){
  const[disp,setDisp]=useState("???");
  const[done,setDone]=useState(false);
  const t=useRef(null);
  useEffect(()=>{setDisp("???");setDone(false);if(t.current)clearInterval(t.current);},[val,stat.key]);
  useEffect(()=>{
    if(t.current)clearInterval(t.current);
    if(hide&&!spin){setDisp("???");setDone(false);return;}
    if(!hide&&!spin){setDisp(val);setDone(true);return;}
    if(spin){let c=0;const ic=stat.key==="green"||stat.key==="snow";
      t.current=setInterval(()=>{c++;if(ic)setDisp(Math.floor(Math.random()*6));else{const r=Math.abs(val)+50;setDisp(Math.floor(Math.random()*r*2-r/2));}
        if(c>=14){clearInterval(t.current);t.current=null;setDisp(val);setDone(true);}},55);}
    return()=>{if(t.current)clearInterval(t.current);};
  },[hide,spin,val,stat.key]);
  const ic=stat.key==="green"||stat.key==="snow";
  const sym=stat.key==="green"?"ğŸŒ¿":"â›„";
  if(!done&&!spin)return <span style={{fontSize:13,fontWeight:800,color:"#666",letterSpacing:2}}>???</span>;
  if(ic){const v=typeof disp==="number"?disp:0;return <span style={{fontSize:11}}>{[0,1,2,3,4].map(i=><span key={i} style={{opacity:i<v?1:0.2}}>{i<v?sym:"Â·"}</span>)}</span>;}
  return <span style={{fontSize:13,fontWeight:800,color:stat.color,opacity:done?1:0.6,textShadow:done?"0 0 6px "+stat.color+"44":"none"}}>{disp}{stat.unit}</span>;
}

/* ======= CARD ======= */
function Card({r,stats,hl,win,click,hide,spin,ed}){
  if(!r||!r.name){
    const ac=ed==="world"?"#e94560":"#ff6b6b";
    return <div style={{width:136,height:200,borderRadius:14,background:"linear-gradient(135deg,#1a1a2e,#0f3460)",border:"3px solid "+ac,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:4}}><span style={{fontSize:26}}>{ed==="world"?"ğŸŒ":"ğŸ—¾"}</span><span style={{color:ac,fontWeight:800,fontSize:9,letterSpacing:2}}>CLIMATE BATTLE</span></div>;
  }
  const isW=ed==="world";const st=stats||(isW?W_ST:J_ST);
  return(
    <div onClick={click} style={{width:136,height:200,borderRadius:14,background:"linear-gradient(160deg,"+r.color+"18,#fff 40%,#fff)",border:"3px solid "+(win?"#FFD700":r.color),boxShadow:win?"0 0 20px rgba(255,215,0,0.6)":"0 3px 10px rgba(0,0,0,0.1)",cursor:click?"pointer":"default",display:"flex",flexDirection:"column",overflow:"hidden",position:"relative"}}>
      {win&&<div style={{position:"absolute",top:-2,right:-2,background:"#FFD700",color:"#333",fontWeight:900,fontSize:9,padding:"2px 7px",borderRadius:"0 11px 0 8px",zIndex:2}}>WIN!</div>}
      <div style={{background:"linear-gradient(135deg,"+r.color+","+r.color+"CC)",padding:"5px 8px",display:"flex",alignItems:"center",gap:5}}>
        <span style={{fontSize:16}}>{r.emoji}</span>
        <div><div style={{color:"#fff",fontWeight:900,fontSize:11,textShadow:"0 1px 2px rgba(0,0,0,0.3)"}}>{r.name}</div><div style={{color:"rgba(255,255,255,0.85)",fontSize:7,fontWeight:700}}>{isW?"é¦–éƒ½:":"çœŒåº:"} {r.capital}</div></div>
      </div>
      <div style={{padding:"2px 5px",flex:1,display:"flex",flexDirection:"column"}}>
        {st.map(s=>{const a=hl===s.key;return(
          <div key={s.key} style={{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"1.5px 4px",borderRadius:6,background:a?s.color+"18":"transparent",border:a?"1.5px solid "+s.color:"1.5px solid transparent"}}>
            <span style={{fontSize:9,display:"flex",alignItems:"center",gap:2}}><span>{s.emoji}</span><span style={{fontWeight:600,color:"#555"}}>{s.label}</span></span>
            <ANum stat={s} val={r[s.key]} hide={hide} spin={spin}/>
          </div>);})}
      </div>
    </div>);
}

/* ======= LOCATION POPUP ======= */
function LocPopup({r,ed,onClose}){
  if(!r)return null;
  const isW=ed==="world";
  const latDir=r.lat>=0?"åŒ—ç·¯":"å—ç·¯";
  const lngDir=r.lng>=0?"æ±çµŒ":"è¥¿çµŒ";
  const latAbs=Math.abs(r.lat).toFixed(1);
  const lngAbs=Math.abs(r.lng).toFixed(1);

  // Simple position hint
  let hint="";
  if(isW){
    if(Math.abs(r.lat)<10)hint="ğŸŒ èµ¤é“ã«è¿‘ã„ï¼â†’ æš‘ãã¦é›¨ãŒå¤šã„ã‹ã‚‚";
    else if(Math.abs(r.lat)<25)hint="ğŸŒ ç†±å¸¯ã€œäºœç†±å¸¯ã‚¾ãƒ¼ãƒ³ â†’ æš‘ã„åœ°åŸŸï¼";
    else if(Math.abs(r.lat)<40)hint="ğŸŒ æ¸©å¸¯ã‚¾ãƒ¼ãƒ³ â†’ å››å­£ãŒã‚ã‚‹ã‹ã‚‚";
    else if(Math.abs(r.lat)<55)hint="ğŸŒ é«˜ç·¯åº¦ â†’ å¯’ã„å†¬ãŒã‚ã‚Šãã†";
    else hint="ğŸŒ ã‹ãªã‚ŠåŒ—ï¼ˆå—ï¼‰â†’ ã™ã”ãå¯’ã„ã‹ã‚‚ï¼";
  }else{
    if(r.lat<30)hint="ğŸ—¾ å—ã®æ–¹ï¼â†’ æš–ã‹ã„ã¯ãš";
    else if(r.lat<35)hint="ğŸ—¾ è¥¿æ—¥æœ¬ã‚ãŸã‚Š â†’ æ¸©æš–ãªåœ°åŸŸ";
    else if(r.lat<38)hint="ğŸ—¾ é–¢æ±ã€œä¸­éƒ¨ã‚ãŸã‚Š";
    else if(r.lat<42)hint="ğŸ—¾ æ±åŒ—ã‚ãŸã‚Š â†’ å†¬ã¯å¯’ã„ã‹ã‚‚";
    else hint="ğŸ—¾ åŒ—æµ·é“ï¼â†’ æ—¥æœ¬ã§ä¸€ç•ªå¯’ã„";
  }

  return(
    <div style={{position:"fixed",inset:0,zIndex:200,background:"rgba(0,0,0,0.7)",display:"flex",alignItems:"center",justifyContent:"center"}} onClick={onClose}>
      <div onClick={e=>e.stopPropagation()} style={{background:"linear-gradient(135deg,#1a1a3e,#2d1b69)",borderRadius:20,padding:"20px 28px",maxWidth:320,color:"#fff",fontFamily:"'Zen Maru Gothic',sans-serif",boxShadow:"0 8px 32px rgba(0,0,0,0.5)"}}>
        <div style={{display:"flex",alignItems:"center",gap:8,marginBottom:12}}>
          <span style={{fontSize:28}}>{r.emoji}</span>
          <div>
            <div style={{fontSize:18,fontWeight:900}}>{r.name}</div>
            <div style={{fontSize:11,opacity:0.7}}>{isW?"é¦–éƒ½:":"çœŒåº:"} {r.capital}</div>
          </div>
        </div>

        <div style={{background:"rgba(255,255,255,0.08)",borderRadius:12,padding:"12px 16px",marginBottom:12}}>
          <div style={{fontSize:11,opacity:0.5,marginBottom:4}}>ğŸ“ ä½ç½®æƒ…å ±</div>
          <div style={{display:"flex",gap:16}}>
            <div>
              <div style={{fontSize:10,opacity:0.6}}>{latDir}</div>
              <div style={{fontSize:22,fontWeight:900,color:"#FFD700"}}>{latAbs}Â°</div>
            </div>
            <div>
              <div style={{fontSize:10,opacity:0.6}}>{lngDir}</div>
              <div style={{fontSize:22,fontWeight:900,color:"#74c0fc"}}>{lngAbs}Â°</div>
            </div>
          </div>
        </div>

        <div style={{background:"rgba(255,215,0,0.1)",border:"1px solid rgba(255,215,0,0.2)",borderRadius:10,padding:"8px 12px",fontSize:12,fontWeight:700,color:"#FFD700",marginBottom:14}}>
          ğŸ’¡ {hint}
        </div>

        <button onClick={onClose} style={{width:"100%",padding:"10px",fontSize:14,fontWeight:800,background:"rgba(255,255,255,0.15)",color:"#fff",border:"none",borderRadius:10,cursor:"pointer"}}>ã¨ã˜ã‚‹</button>
      </div>
    </div>
  );
}

function HiLo({high}){
  return <div style={{display:"inline-flex",alignItems:"center",gap:5,padding:"4px 14px",borderRadius:30,fontWeight:900,fontSize:14,background:high?"linear-gradient(135deg,#ff6b6b,#e03131)":"linear-gradient(135deg,#74c0fc,#1c7ed6)",color:"#fff"}}>{high?"ğŸ”º HIGH é«˜ã„æ–¹ãŒå‹ã¡ï¼":"ğŸ”» LOW ä½ã„æ–¹ãŒå‹ã¡ï¼"}</div>;
}

function LvB({lv}){
  const n=LVN[Math.min(lv,7)]||"???";const c=LVC[Math.min(lv,7)]||"#fff";
  return <div style={{display:"flex",alignItems:"center",gap:4,background:c+"22",border:"2px solid "+c,borderRadius:20,padding:"2px 10px",fontSize:11,fontWeight:800,color:c}}>Lv.{lv} {n}{lv>=6&&<span style={{fontSize:8,opacity:0.7}}>æ··åˆ</span>}</div>;
}

/* ======= TITLE ======= */
function Title({onStart,ed,setEd,d}){
  const isW=ed==="world";const ac=isW?"#e94560":"#ff6b6b";const ac2=isW?"#00b4d8":"#48dbfb";
  const lv=isW?d.worldLv:d.japanLv;const best=isW?d.worldBest:d.japanBest;
  return(
    <div style={{minHeight:"100vh",background:isW?"linear-gradient(135deg,#0f0c29,#302b63,#24243e)":"linear-gradient(135deg,#1a0a2e,#2d1b69,#1a1a3e)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontFamily:"'Zen Maru Gothic',sans-serif"}}>
      <style>{`@import url('https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;700;900&display=swap');`}</style>
      <div style={{display:"flex",background:"rgba(255,255,255,0.08)",borderRadius:14,padding:4,marginBottom:18}}>
        {["world","japan"].map(k=><button key={k} onClick={()=>setEd(k)} style={{padding:"9px 22px",borderRadius:11,border:"none",cursor:"pointer",background:ed===k?(k==="world"?"linear-gradient(135deg,#e94560,#c23152)":"linear-gradient(135deg,#ff6b6b,#ee5a24)"):"transparent",color:"#fff",fontWeight:800,fontSize:14,opacity:ed===k?1:0.5}}>{k==="world"?"ğŸŒ ä¸–ç•Œç·¨":"ğŸ—¾ æ—¥æœ¬ç·¨"}</button>)}
      </div>
      <div style={{fontSize:48,marginBottom:4}}>{isW?"ğŸŒ":"ğŸ—¾"}</div>
      <h1 style={{fontSize:28,fontWeight:900,color:"#fff",margin:0}}>æ°—å€™ãƒãƒˆãƒ«ã‚«ãƒ¼ãƒ‰</h1>
      <div style={{fontSize:16,color:ac,fontWeight:700,letterSpacing:4,marginTop:4}}>ï½{isW?"ä¸–ç•Œç·¨":"éƒ½é“åºœçœŒç·¨"}ï½</div>
      <div style={{display:"flex",gap:10,marginTop:14,alignItems:"center"}}>
        <LvB lv={lv}/>
        <div style={{textAlign:"center",background:"rgba(255,255,255,0.06)",borderRadius:10,padding:"5px 12px"}}><div style={{fontSize:8,color:"rgba(255,255,255,0.5)"}}>ğŸ†æœ€é«˜é€£å‹</div><div style={{fontSize:18,fontWeight:900,color:"#FFD700"}}>{best}</div></div>
        <div style={{textAlign:"center",background:"rgba(255,255,255,0.06)",borderRadius:10,padding:"5px 12px"}}><div style={{fontSize:8,color:"rgba(255,255,255,0.5)"}}>â­é€šç®—å‹åˆ©</div><div style={{fontSize:18,fontWeight:900,color:"#fff"}}>{d.totalWins}</div></div>
      </div>
      <div style={{marginTop:8,fontSize:11,color:"rgba(255,255,255,0.4)",textAlign:"center"}}>{lv<=5?"æœ€é«˜æ°—æ¸©ãƒ»é™æ°´é‡ã¯HIGHå›ºå®š":"æœ€é«˜æ°—æ¸©ãƒ»é™æ°´é‡ã¯HIGHï¼†LOWæ··åˆï¼"}ã€€|ã€€å…ˆã«4å‹ã§å‹ã¡ï¼</div>
      <div style={{display:"flex",gap:12,marginTop:18,flexWrap:"wrap",justifyContent:"center"}}>
        <div style={{textAlign:"center"}}>
          <button onClick={()=>onStart("quick")} style={{padding:"13px 28px",fontSize:15,fontWeight:800,background:"linear-gradient(135deg,"+ac+","+ac+"CC)",color:"#fff",border:"none",borderRadius:14,cursor:"pointer"}}>ğŸ² ã‚¯ã‚¤ãƒƒã‚¯ãƒãƒˆãƒ«</button>
          <div style={{fontSize:9,color:"rgba(255,255,255,0.4)",marginTop:4}}>æ•°å€¤ã‚’è¦‹ã¦é¸ã¹ã‚‹</div>
        </div>
        <div style={{textAlign:"center"}}>
          <button onClick={()=>onStart("think")} style={{padding:"13px 28px",fontSize:15,fontWeight:800,background:"linear-gradient(135deg,"+ac2+","+ac2+"CC)",color:"#fff",border:"none",borderRadius:14,cursor:"pointer"}}>ğŸ§  æ€è€ƒãƒãƒˆãƒ«</button>
          <div style={{fontSize:9,color:"rgba(255,255,255,0.4)",marginTop:4}}>æ•°å€¤ã¯éš ã‚Œã‚‹ï¼çŸ¥è­˜ã§å‹è² </div>
        </div>
      </div>
    </div>);
}

/* ======= BATTLE ======= */
function Battle({mode,ed,lv,best,onBack,onEnd}){
  const isW=ed==="world";const POOL=isW?WORLD:JAPAN;const STATS=isW?W_ST:J_ST;
  const ac=isW?"#e94560":"#ff6b6b";const ac2=isW?"#00b4d8":"#48dbfb";

  const[ph,setPh]=useState("init");
  const[pH,setPH]=useState([]);
  const[cH,setCH]=useState([]);
  const[pC,setPC]=useState(null);
  const[cC,setCC]=useState(null);
  const[st,setSt]=useState(null);
  const[hi,setHi]=useState(true);
  const[pS,setPS]=useState(0);
  const[cS,setCS]=useState(0);
  const[rd,setRd]=useState(0);
  const[msg,setMsg]=useState("");
  const[tip,setTip]=useState("");
  const[spin,setSpin]=useState(false);
  const[streak,setStreak]=useState(0);
  const[used,setUsed]=useState([]);
  const[locTarget,setLocTarget]=useState(null);
  const[bStep,setBStep]=useState(0);
  const[pDeck,setPDeck]=useState([]); // player draw pile
  const[cDeck,setCDeck]=useState([]); // cpu draw pile
  const pend=useRef(null);
  const stepTimer=useRef(null);

  useEffect(()=>{
    const all=shuffle(POOL);
    const half=Math.floor(all.length/2);
    const pAll=all.slice(0,half);
    const cAll=all.slice(half);
    setPH(pAll.slice(0,6));
    setPDeck(pAll.slice(6));
    setCH(cAll.slice(0,6));
    setCDeck(cAll.slice(6));
    setRd(1);
    newCh([],true);
  },[]);

  function newCh(prev){
    const av=STATS.filter(s=>!prev.includes(s.key));const p=av.length>0?av:STATS;
    const s=p[Math.floor(Math.random()*p.length)];const h=getHiLo(s.key, lv);
    setSt(s);setHi(h);setPC(null);setCC(null);setSpin(false);setTip("");
    setUsed(u=>[...u,s.key]);setMsg(s.emoji+" "+s.label+"ã§å‹è² ï¼");setPh("pickC");
  }


  function play(card){
    if(ph!=="pickC")return;const cpu=cH[0];
    // Remove played cards from hands
    const newPH=pH.filter(c=>c.id!==card.id);
    const newCH=cH.slice(1);
    // Draw from deck if available
    if(pDeck.length>0){
      newPH.push(pDeck[0]);
      setPDeck(d=>d.slice(1));
    }
    if(cDeck.length>0){
      newCH.push(cDeck[0]);
      setCDeck(d=>d.slice(1));
    }
    setPH(newPH);
    setCH(newCH);
    setPC(card);setCC(cpu);
    pend.current={card,cpu};
    setMsg("");setTip("");setSpin(false);
    setPh("battle");
    setBStep(1); // Step 1: show stat

    // Clear any previous timers
    if(stepTimer.current) clearTimeout(stepTimer.current);

    stepTimer.current = setTimeout(()=>{
      setBStep(2); // Step 2: player enters
      stepTimer.current = setTimeout(()=>{
        setBStep(3); // Step 3: cpu spin
        setSpin(true);
        stepTimer.current = setTimeout(()=>{
          setSpin(false);
          // Step 4: judge
          const pV=card[st.key],cV=cpu[st.key];
          const pw=hi?pV>cV:pV<cV;
          if(pV===cV)setMsg("ğŸ¤ å¼•ãåˆ†ã‘ï¼");
          else if(pw){setPS(s=>s+1);setStreak(s=>s+1);setMsg("ğŸ‰ ã‚­ãƒŸã®å‹ã¡ï¼");}
          else{setCS(s=>s+1);setStreak(0);setMsg("ğŸ˜ˆ ç›¸æ‰‹ã®å‹ã¡...");}
          const ns=[card.name,cpu.name];
          if(isW){
            if(st.key==="maxTemp"&&ns.includes("ã‚µã‚¦ã‚¸ã‚¢ãƒ©ãƒ“ã‚¢"))setTip("ğŸ¤¯ ãƒªãƒ¤ãƒ‰ã¯50â„ƒè¶…ãˆï¼ä¸–ç•Œä¸€æš‘ã„é¦–éƒ½ï¼");
            else if(st.key==="minTemp"&&ns.includes("ãƒ¢ãƒ³ã‚´ãƒ«"))setTip("ğŸ¤¯ ã‚¦ãƒ©ãƒ³ãƒãƒ¼ãƒˆãƒ«ã¯-40â„ƒï¼ä¸–ç•Œä¸€å¯’ã„é¦–éƒ½ï¼");
            else if(st.key==="rainfall"&&ns.includes("ã‚¨ã‚¸ãƒ—ãƒˆ"))setTip("ğŸ¤¯ ã‚«ã‚¤ãƒ­ã®é›¨ã¯æ±äº¬ã®60åˆ†ã®1ï¼");
          }else{
            if(st.key==="rainfall"&&ns.includes("é«˜çŸ¥"))setTip("ğŸ¤¯ é«˜çŸ¥ã¯æ—¥æœ¬ä¸€ã®é›¨é‡ï¼æ±äº¬ã®1.7å€ï¼");
            else if(st.key==="snow"&&ns.includes("æ²–ç¸„"))setTip("ğŸ¤¯ æ²–ç¸„ã¯ã»ã¼é›ªã‚¼ãƒ­ï¼");
            else if(st.key==="maxTemp"&&ns.includes("äº¬éƒ½"))setTip("ğŸ¤¯ ç›†åœ°ã®äº¬éƒ½ã¯çŒ›æš‘ï¼");
          }
          setBStep(4);
          setPh("res");
        },1200); // spin duration
      },800); // after player shown
    },800); // after stat shown
  }


  function next(){
    if(stepTimer.current) clearTimeout(stepTimer.current);
    setBStep(0);
    if(pS>=4||cS>=4){onEnd(pS>=4,streak);setPh("end");return;}
    setRd(r=>r+1);setSt(null);setSpin(false);
    newCh(used);
  }

  if(ph==="end"){
    const won=pS>=4;
    return(
      <div style={{minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:won?"linear-gradient(135deg,#FFD700,#FFA500)":"linear-gradient(135deg,#4a6fa5,#2d3a4a)",fontFamily:"'Zen Maru Gothic',sans-serif"}}>
        <style>{`@import url('https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;700;900&display=swap');`}</style>
        <div style={{fontSize:56}}>{won?"ğŸ†":"ğŸ’ª"}</div>
        <h2 style={{color:"#fff",fontSize:24,fontWeight:900,margin:"10px 0"}}>{won?"ã‚­ãƒŸã®å‹ã¡ï¼":"æ®‹å¿µ...æ¬¡ã“ãï¼"}</h2>
        <div style={{color:"#fff",fontSize:20,fontWeight:700}}>{pS} - {cS}</div>
        {won&&<div style={{marginTop:6}}><LvB lv={lv}/></div>}
        {won&&<div style={{color:"#fff",fontSize:12,marginTop:4}}>â†’ æ¬¡ã¯ Lv.{Math.min(lv+1,7)}ï¼</div>}
        {streak>=2&&<div style={{color:"#fff",fontSize:12,marginTop:4}}>ğŸ”¥ {streak}é€£å‹ï¼</div>}
        <button onClick={onBack} style={{marginTop:18,padding:"11px 26px",fontSize:14,fontWeight:800,background:"#fff",color:"#333",border:"none",borderRadius:12,cursor:"pointer"}}>ğŸ  ã‚‚ã©ã‚‹</button>
      </div>);
  }

  const cpuN=cH[0];const isRes=ph==="res";const isSpin=ph==="spin";

  return(
    <div style={{minHeight:"100vh",background:isW?"linear-gradient(180deg,#0f0c29,#1a1a3e)":"linear-gradient(180deg,#1a0a2e,#1a1a3e)",fontFamily:"'Zen Maru Gothic',sans-serif",color:"#fff",padding:"10px 6px",display:"flex",flexDirection:"column",alignItems:"center"}}>
      <style>{`@import url('https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;700;900&display=swap');`}</style>

      {/* Location popup */}
      {locTarget&&<LocPopup r={locTarget} ed={ed} onClose={()=>setLocTarget(null)}/>}


      {/* Header */}
      <div style={{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%",maxWidth:500,marginBottom:4}}>
        <button onClick={onBack} style={{background:"rgba(255,255,255,0.1)",border:"none",color:"#fff",padding:"5px 12px",borderRadius:8,cursor:"pointer",fontSize:12,fontWeight:700}}>â† ã‚‚ã©ã‚‹</button>
        <div style={{display:"flex",alignItems:"center",gap:6}}>
          <LvB lv={lv}/>
          {mode==="think"&&<span style={{fontSize:9,fontWeight:800,color:"#48dbfb",background:"rgba(72,219,251,0.15)",padding:"2px 8px",borderRadius:10}}>ğŸ§ æ€è€ƒ</span>}
        </div>
        <div style={{fontSize:11,fontWeight:700}}>R{rd} ğŸƒ{pDeck.length+pH.length}</div>
      </div>

      {/* Score */}
      <div style={{display:"flex",gap:6,alignItems:"center",marginBottom:4,width:"100%",maxWidth:340}}>
        <div style={{textAlign:"center",minWidth:36}}><div style={{fontSize:9,opacity:0.6}}>ã‚­ãƒŸ</div><div style={{fontSize:20,fontWeight:900,color:ac}}>{pS}</div></div>
        <div style={{flex:1,display:"flex",gap:3,justifyContent:"center"}}>
          {[0,1,2,3,4,5,6].map(i=>{const pw=i<pS;const cw=i>=7-cS;
            return <div key={i} style={{width:13,height:13,borderRadius:3,background:pw?ac:cw?ac2:"rgba(255,255,255,0.1)",border:"1.5px solid "+(pw?ac:cw?ac2:"rgba(255,255,255,0.15)")}}/>;
          })}
        </div>
        <div style={{textAlign:"center",minWidth:36}}><div style={{fontSize:9,opacity:0.6}}>ç›¸æ‰‹</div><div style={{fontSize:20,fontWeight:900,color:ac2}}>{cS}</div></div>
      </div>
      <div style={{fontSize:8,opacity:0.4,marginBottom:3}}>å…ˆã«4å‹ã—ãŸæ–¹ãŒå‹ã¡ï¼</div>

      {/* Streak */}
      {streak>=2&&<div style={{marginBottom:3,background:streak>=5?"linear-gradient(135deg,#FFD700,#FFA500)":streak>=3?"linear-gradient(135deg,#ff6b6b,#e94560)":"rgba(255,255,255,0.1)",padding:"2px 10px",borderRadius:20,fontSize:10,fontWeight:800,color:streak>=3?"#fff":"#ccc"}}>ğŸ”¥{streak}é€£å‹ï¼{streak>best&&streak>=3?" ğŸ…NEW!":""}</div>}

      {/* Challenge banner */}
      {/* Challenge banner - only before battle */}
      {st&&ph==="pickC"&&(
        <div style={{display:"flex",flexDirection:"column",alignItems:"center",gap:6,background:"linear-gradient(135deg,rgba(255,255,255,0.08),rgba(255,255,255,0.03))",border:"2px solid rgba(255,255,255,0.12)",borderRadius:16,padding:"10px 24px",marginBottom:6,minWidth:280}}>
          <div style={{display:"flex",alignItems:"center",gap:8}}>
            <span style={{fontSize:32}}>{st.emoji}</span>
            <span style={{fontSize:22,fontWeight:900,color:st.color,textShadow:"0 0 12px "+st.color+"44"}}>{st.label}</span>
            <span style={{fontSize:14,fontWeight:700,color:"rgba(255,255,255,0.5)"}}>ã§å‹è² ï¼</span>
          </div>
          <HiLo high={hi}/>
        </div>
      )}

      {/* Battle area */}
      {(
        <div style={{display:"flex",flexDirection:"column",alignItems:"center",marginBottom:4}}>
          {/* Cards row - only show when not in battle sequence or in pickC */}
          {(ph==="pickC"||bStep===0)&&(
            <div style={{display:"flex",gap:8,alignItems:"flex-start",justifyContent:"center",minHeight:210}}>
              {pC? <Card r={pC} stats={STATS} hl={st?.key} ed={ed}/>
                :<div style={{width:136,height:200,borderRadius:14,border:"2px dashed rgba(255,255,255,0.2)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,color:"rgba(255,255,255,0.3)"}}>ã‚«ãƒ¼ãƒ‰ã‚’é¸ã¼ã†</div>}
              <div style={{display:"flex",alignItems:"center",height:200,fontSize:22,fontWeight:900}}>âš¡</div>
              {cpuN?<div style={{position:"relative"}}>
                <Card r={cpuN} stats={STATS} hide={true} ed={ed}/>
                <button onClick={()=>setLocTarget(cpuN)} style={{position:"absolute",bottom:4,left:"50%",transform:"translateX(-50%)",background:"rgba(255,255,255,0.15)",border:"1.5px solid rgba(255,255,255,0.3)",borderRadius:8,padding:"3px 10px",fontSize:9,fontWeight:700,color:"#FFD700",cursor:"pointer",display:"flex",alignItems:"center",gap:3,whiteSpace:"nowrap"}}>ğŸ“ãƒ’ãƒ³ãƒˆ</button>
              </div>
              :<Card ed={ed}/>}
            </div>
          )}

          {/* === BATTLE SEQUENCE PANEL === */}
          {bStep >= 1 && st && pC && cC && (
            <div style={{
              width:"100%",maxWidth:400,
              background:"linear-gradient(180deg,rgba(0,0,0,0.4),rgba(0,0,0,0.2))",
              border:"2px solid rgba(255,255,255,0.08)",
              borderRadius:20,padding:"16px 20px",
              minHeight:180,
              display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",
            }}>

              {/* Step 1: Stat announcement */}
              <div style={{
                opacity:bStep>=1?1:0,
                transform:bStep>=1?"scale(1)":"scale(0.5)",
                transition:"all 0.4s cubic-bezier(0.34,1.56,0.64,1)",
                display:"flex",flexDirection:"column",alignItems:"center",gap:6,marginBottom:bStep>=2?12:0,
              }}>
                <div style={{display:"flex",alignItems:"center",gap:8}}>
                  <span style={{fontSize:36}}>{st.emoji}</span>
                  <span style={{fontSize:24,fontWeight:900,color:st.color,textShadow:"0 0 16px "+st.color+"55"}}>{st.label}</span>
                </div>
                <HiLo high={hi}/>
              </div>

              {/* Step 2+: Player entry */}
              {bStep >= 2 && (
                <div style={{
                  display:"flex",alignItems:"center",justifyContent:"center",width:"100%",gap:0,
                }}>
                  {/* Player side */}
                  <div style={{
                    flex:1,textAlign:"center",
                    opacity:bStep>=2?1:0,
                    transform:bStep>=2?"translateX(0)":"translateX(-40px)",
                    transition:"all 0.5s cubic-bezier(0.34,1.56,0.64,1)",
                  }}>
                    <div style={{fontSize:24,marginBottom:2}}>{pC.emoji}</div>
                    <div style={{fontSize:14,fontWeight:800,color:"#fff",marginBottom:4}}>{pC.name}</div>
                    <div style={{
                      fontSize: (st.key==="green"||st.key==="snow") ? 26 : 42,
                      fontWeight:900,
                      color: bStep===4 ? (msg.includes("ã‚­ãƒŸ") ? "#FFD700" : msg.includes("å¼•ãåˆ†ã‘") ? "#fff" : "rgba(255,255,255,0.3)") : st.color,
                      textShadow: bStep===4 && msg.includes("ã‚­ãƒŸ") ? "0 0 24px rgba(255,215,0,0.6)" : "none",
                      transition:"all 0.4s",
                      lineHeight:1,
                    }}>
                      {(st.key==="green"||st.key==="snow") ? (
                        <span>{[0,1,2,3,4].map(i => <span key={i} style={{opacity:i<pC[st.key]?1:0.15,fontSize:24}}>{i<pC[st.key]?(st.key==="green"?"ğŸŒ¿":"â›„"):"Â·"}</span>)}</span>
                      ) : (
                        <span>{pC[st.key]}<span style={{fontSize:18,fontWeight:700}}>{st.unit}</span></span>
                      )}
                    </div>
                    {bStep===4 && msg.includes("ã‚­ãƒŸ") && <div style={{fontSize:14,fontWeight:900,color:"#FFD700",marginTop:4}}>ğŸ‘‘ WIN!</div>}
                    {bStep===4 && msg.includes("ç›¸æ‰‹") && <div style={{fontSize:11,color:"rgba(255,255,255,0.3)",marginTop:4}}>LOSE</div>}
                  </div>

                  {/* VS divider */}
                  <div style={{
                    fontSize:22,fontWeight:900,color:"rgba(255,255,255,0.2)",
                    padding:"0 8px",
                    opacity:bStep>=3?1:0,
                    transition:"all 0.3s",
                  }}>VS</div>

                  {/* CPU side */}
                  <div style={{
                    flex:1,textAlign:"center",
                    opacity:bStep>=3?1:0,
                    transform:bStep>=3?"translateX(0)":"translateX(40px)",
                    transition:"all 0.5s cubic-bezier(0.34,1.56,0.64,1)",
                  }}>
                    <div style={{fontSize:24,marginBottom:2}}>{cC.emoji}</div>
                    <div style={{fontSize:14,fontWeight:800,color:"#fff",marginBottom:4}}>{cC.name}</div>
                    <div style={{
                      fontSize: (st.key==="green"||st.key==="snow") ? 26 : 42,
                      fontWeight:900,
                      color: bStep===4 ? (msg.includes("ç›¸æ‰‹") ? "#74c0fc" : msg.includes("å¼•ãåˆ†ã‘") ? "#fff" : "rgba(255,255,255,0.3)") : "rgba(255,255,255,0.5)",
                      textShadow: bStep===4 && msg.includes("ç›¸æ‰‹") ? "0 0 24px rgba(116,192,252,0.6)" : "none",
                      transition:"all 0.4s",
                      lineHeight:1,
                      fontFamily: bStep===3?"monospace":"inherit",
                    }}>
                      {bStep===3 ? (
                        <ANum stat={st} val={cC[st.key]} hide={false} spin={true}/>
                      ) : bStep===4 ? (
                        (st.key==="green"||st.key==="snow") ? (
                          <span>{[0,1,2,3,4].map(i => <span key={i} style={{opacity:i<cC[st.key]?1:0.15,fontSize:24}}>{i<cC[st.key]?(st.key==="green"?"ğŸŒ¿":"â›„"):"Â·"}</span>)}</span>
                        ) : (
                          <span>{cC[st.key]}<span style={{fontSize:18,fontWeight:700}}>{st.unit}</span></span>
                        )
                      ) : <span style={{letterSpacing:4,color:"rgba(255,255,255,0.2)"}}>???</span>}
                    </div>
                    {bStep===4 && msg.includes("ç›¸æ‰‹") && <div style={{fontSize:14,fontWeight:900,color:"#74c0fc",marginTop:4}}>ğŸ‘‘ WIN!</div>}
                    {bStep===4 && msg.includes("ã‚­ãƒŸ") && <div style={{fontSize:11,color:"rgba(255,255,255,0.3)",marginTop:4}}>LOSE</div>}
                  </div>
                </div>
              )}

              {/* Step 4: Result message */}
              {bStep===4 && (
                <div style={{
                  marginTop:12,fontSize:20,fontWeight:900,
                  color:msg.includes("ã‚­ãƒŸ")?"#FFD700":msg.includes("ç›¸æ‰‹")?"#74c0fc":"#fff",
                  textShadow:msg.includes("ã‚­ãƒŸ")?"0 0 16px rgba(255,215,0,0.4)":msg.includes("ç›¸æ‰‹")?"0 0 16px rgba(116,192,252,0.4)":"none",
                }}>{msg}</div>
              )}
            </div>
          )}
        </div>
      )}

      {/* Tip */}
      {tip&&<div style={{background:"rgba(255,215,0,0.15)",border:"1px solid rgba(255,215,0,0.3)",borderRadius:12,padding:"5px 12px",fontSize:11,fontWeight:700,maxWidth:360,textAlign:"center",marginBottom:4,color:"#FFD700"}}>{tip}</div>}

      {/* Next */}
      {isRes&&<button onClick={next} style={{padding:"9px 22px",fontSize:14,fontWeight:800,background:"linear-gradient(135deg,"+ac+","+ac+"CC)",color:"#fff",border:"none",borderRadius:12,cursor:"pointer",marginBottom:6}}>{pS>=4||cS>=4?"çµæœã‚’è¦‹ã‚‹ â†’":"æ¬¡ã®ãƒ©ã‚¦ãƒ³ãƒ‰ â†’"}</button>}

      {/* Player hand */}
      {pH.length>0&&(
        <div style={{marginTop:2,width:"100%"}}>
          <div style={{fontSize:11,opacity:0.6,marginBottom:4,textAlign:"center"}}>
            {ph==="pickC"?"â†“ ç›¸æ‰‹ã¯ã€Œ"+(cpuN?.emoji||"")+" "+(cpuN?.name||"")+"ã€ï¼ã‚¿ãƒƒãƒ—ï¼"
              :"æ‰‹æœ­ï¼ˆæ®‹ã‚Š"+pH.length+"æšï¼‰"}
          </div>
          <div style={{display:"flex",gap:6,padding:"2px 4px",justifyContent:"center",flexWrap:"wrap"}}>
            {pH.map(c=>(
              <div key={c.id} style={{cursor:ph==="pickC"?"pointer":"default",opacity:ph==="pickC"?1:0.8,transition:"transform 0.2s"}}
                onMouseEnter={e=>{if(ph==="pickC")e.currentTarget.style.transform="translateY(-5px)";}}
                onMouseLeave={e=>{e.currentTarget.style.transform="translateY(0)";}}>
                <Card r={c} stats={STATS} hl={st?.key} click={ph==="pickC"?()=>play(c):undefined} ed={ed} hide={mode==="think"}/>
              </div>))}
          </div>
        </div>)}
    </div>);
}

/* ======= MAIN ======= */
function App(){
  const{d,up,ok}=useData();
  const[scr,setScr]=useState("title");
  const[mode,setMode]=useState("quick");
  const[ed,setEd]=useState("world");

  function handleEnd(won,fs){
    if(won){up(d=>{const n={...d,totalWins:d.totalWins+1};const lk=ed==="world"?"worldLv":"japanLv";const bk=ed==="world"?"worldBest":"japanBest";n[lk]=Math.min(d[lk]+1,7);if(fs>d[bk])n[bk]=fs;return n;});}
  }

  if(!ok)return <div style={{minHeight:"100vh",background:"#0f0c29",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:16}}>èª­ã¿è¾¼ã¿ä¸­...</div>;

  const lv=ed==="world"?d.worldLv:d.japanLv;
  const best=ed==="world"?d.worldBest:d.japanBest;

  if(scr==="title")return <Title ed={ed} setEd={setEd} d={d} onStart={m=>{setMode(m);setScr("battle");}}/>;
  return <Battle key={ed+mode+Date.now()} mode={mode} ed={ed} lv={lv} best={best} onBack={()=>setScr("title")} onEnd={handleEnd}/>;
}

ReactDOM.createRoot(document.getElementById('root')).render(React.createElement(App));
  </script>
</body>
</html>
